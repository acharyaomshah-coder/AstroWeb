{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///D:/DEMO-PROJECTS/AstroWeb/src/lib/supabase.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || \"https://your-project.supabase.co\";\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || \"your-anon-key\";\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);\r\n\r\nexport async function getAuthToken() {\r\n  try {\r\n    const { data: { session } } = await supabase.auth.getSession();\r\n    return session?.access_token || null;\r\n  } catch (error) {\r\n    console.error(\"Error getting auth token:\", error);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function signUp(email: string, password: string) {\r\n  return await supabase.auth.signUp({ email, password });\r\n}\r\n\r\nexport async function signIn(email: string, password: string) {\r\n  return await supabase.auth.signInWithPassword({ email, password });\r\n}\r\n\r\nexport async function signOut() {\r\n  return await supabase.auth.signOut();\r\n}\r\n\r\nexport async function getCurrentUser() {\r\n  const { data: { user } } = await supabase.auth.getUser();\r\n  return user;\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;;AAEA,MAAM,cAAc,gFAAwC;AAC5D,MAAM,kBAAkB,wPAA6C;AAE9D,MAAM,WAAW,IAAA,iKAAY,EAAC,aAAa;AAE3C,eAAe;IACpB,IAAI;QACF,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,UAAU;QAC5D,OAAO,SAAS,gBAAgB;IAClC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO;IACT;AACF;AAEO,eAAe,OAAO,KAAa,EAAE,QAAgB;IAC1D,OAAO,MAAM,SAAS,IAAI,CAAC,MAAM,CAAC;QAAE;QAAO;IAAS;AACtD;AAEO,eAAe,OAAO,KAAa,EAAE,QAAgB;IAC1D,OAAO,MAAM,SAAS,IAAI,CAAC,kBAAkB,CAAC;QAAE;QAAO;IAAS;AAClE;AAEO,eAAe;IACpB,OAAO,MAAM,SAAS,IAAI,CAAC,OAAO;AACpC;AAEO,eAAe;IACpB,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;IACtD,OAAO;AACT"}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///D:/DEMO-PROJECTS/AstroWeb/src/pages/api/videos.ts"],"sourcesContent":["import { NextApiRequest, NextApiResponse } from \"next\";\r\nimport { supabase } from \"@/lib/supabase\";\r\n\r\nconst ADMIN_EMAILS = [\"aacharyaomshah@gmail.com\"];\r\nconst ADMIN_DOMAINS = [\"@admin.divine\"];\r\n\r\nconst isAdminUser = (email: string | undefined) => {\r\n    if (!email) return false;\r\n    return ADMIN_EMAILS.includes(email) || ADMIN_DOMAINS.some(domain => email.endsWith(domain));\r\n};\r\n\r\nexport default async function handler(req: NextApiRequest, res: NextApiResponse) {\r\n    if (req.method === \"GET\") {\r\n        // Fetch videos\r\n        const { data: videos, error } = await supabase\r\n            .from(\"videos\")\r\n            .select(\"*\")\r\n            .order(\"created_at\", { ascending: false });\r\n\r\n        if (error) {\r\n            console.error(\"Error fetching videos:\", error);\r\n            return res.status(500).json({ error: \"Failed to fetch videos\" });\r\n        }\r\n\r\n        // Transform snake_case to camelCase for frontend\r\n        const formattedVideos = videos.map(video => ({\r\n            id: video.id,\r\n            title: video.title,\r\n            youtubeUrl: video.youtube_url,\r\n            thumbnailUrl: video.thumbnail_url,\r\n            createdAt: video.created_at\r\n        }));\r\n\r\n        return res.status(200).json(formattedVideos);\r\n    }\r\n\r\n    if (req.method === \"POST\") {\r\n        // Check authentication\r\n        const authHeader = req.headers.authorization;\r\n        if (!authHeader) {\r\n            return res.status(401).json({ error: \"Missing authorization header\" });\r\n        }\r\n\r\n        const token = authHeader.replace(\"Bearer \", \"\");\r\n        const { data: { user }, error: authError } = await supabase.auth.getUser(token);\r\n\r\n        if (authError || !user || !isAdminUser(user.email)) {\r\n            return res.status(403).json({ error: \"Unauthorized\" });\r\n        }\r\n\r\n        const { title, youtubeUrl, thumbnailUrl } = req.body;\r\n\r\n        if (!title || !youtubeUrl || !thumbnailUrl) {\r\n            return res.status(400).json({ error: \"Missing required fields\" });\r\n        }\r\n\r\n        const { data, error } = await supabase\r\n            .from(\"videos\")\r\n            .insert([\r\n                {\r\n                    title,\r\n                    youtube_url: youtubeUrl,\r\n                    thumbnail_url: thumbnailUrl\r\n                }\r\n            ])\r\n            .select()\r\n            .single();\r\n\r\n        if (error) {\r\n            console.error(\"Error adding video:\", error);\r\n            return res.status(500).json({ error: error.message || \"Failed to add video\", details: error });\r\n            // return res.status(500).json({ error: \"Failed to add video\" });\r\n        }\r\n\r\n        return res.status(201).json({\r\n            id: data.id,\r\n            title: data.title,\r\n            youtubeUrl: data.youtube_url,\r\n            thumbnailUrl: data.thumbnail_url,\r\n            createdAt: data.created_at\r\n        });\r\n    }\r\n\r\n    return res.status(405).json({ error: \"Method not allowed\" });\r\n}\r\n"],"names":[],"mappings":";;;;AACA;;AAEA,MAAM,eAAe;IAAC;CAA2B;AACjD,MAAM,gBAAgB;IAAC;CAAgB;AAEvC,MAAM,cAAc,CAAC;IACjB,IAAI,CAAC,OAAO,OAAO;IACnB,OAAO,aAAa,QAAQ,CAAC,UAAU,cAAc,IAAI,CAAC,CAAA,SAAU,MAAM,QAAQ,CAAC;AACvF;AAEe,eAAe,QAAQ,GAAmB,EAAE,GAAoB;IAC3E,IAAI,IAAI,MAAM,KAAK,OAAO;QACtB,eAAe;QACf,MAAM,EAAE,MAAM,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,2JAAQ,CACzC,IAAI,CAAC,UACL,MAAM,CAAC,KACP,KAAK,CAAC,cAAc;YAAE,WAAW;QAAM;QAE5C,IAAI,OAAO;YACP,QAAQ,KAAK,CAAC,0BAA0B;YACxC,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO;YAAyB;QAClE;QAEA,iDAAiD;QACjD,MAAM,kBAAkB,OAAO,GAAG,CAAC,CAAA,QAAS,CAAC;gBACzC,IAAI,MAAM,EAAE;gBACZ,OAAO,MAAM,KAAK;gBAClB,YAAY,MAAM,WAAW;gBAC7B,cAAc,MAAM,aAAa;gBACjC,WAAW,MAAM,UAAU;YAC/B,CAAC;QAED,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;IAChC;IAEA,IAAI,IAAI,MAAM,KAAK,QAAQ;QACvB,uBAAuB;QACvB,MAAM,aAAa,IAAI,OAAO,CAAC,aAAa;QAC5C,IAAI,CAAC,YAAY;YACb,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO;YAA+B;QACxE;QAEA,MAAM,QAAQ,WAAW,OAAO,CAAC,WAAW;QAC5C,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,OAAO,SAAS,EAAE,GAAG,MAAM,2JAAQ,CAAC,IAAI,CAAC,OAAO,CAAC;QAEzE,IAAI,aAAa,CAAC,QAAQ,CAAC,YAAY,KAAK,KAAK,GAAG;YAChD,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO;YAAe;QACxD;QAEA,MAAM,EAAE,KAAK,EAAE,UAAU,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI;QAEpD,IAAI,CAAC,SAAS,CAAC,cAAc,CAAC,cAAc;YACxC,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO;YAA0B;QACnE;QAEA,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,2JAAQ,CACjC,IAAI,CAAC,UACL,MAAM,CAAC;YACJ;gBACI;gBACA,aAAa;gBACb,eAAe;YACnB;SACH,EACA,MAAM,GACN,MAAM;QAEX,IAAI,OAAO;YACP,QAAQ,KAAK,CAAC,uBAAuB;YACrC,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO,MAAM,OAAO,IAAI;gBAAuB,SAAS;YAAM;QAC5F,iEAAiE;QACrE;QAEA,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YACxB,IAAI,KAAK,EAAE;YACX,OAAO,KAAK,KAAK;YACjB,YAAY,KAAK,WAAW;YAC5B,cAAc,KAAK,aAAa;YAChC,WAAW,KAAK,UAAU;QAC9B;IACJ;IAEA,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;QAAE,OAAO;IAAqB;AAC9D"}}]
}